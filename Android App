package com.example.smartagent


import android.service.notification.NotificationListenerService
import android.service.notification.StatusBarNotification
import okhttp3.*
import org.json.JSONObject


class KakaoService : NotificationListenerService() {
override fun onNotificationPosted(sbn: StatusBarNotification) {
if (sbn.packageName != "com.kakao.talk") return


val msg = sbn.notification.extras.getCharSequence("android.text")?.toString() ?: return


val json = JSONObject().put("text", msg)
val body = RequestBody.create(MediaType.parse("application/json"), json.toString())


OkHttpClient().newCall(
Request.Builder()
.url("http://SERVER:8000/reply")
.post(body)
.build()
).execute()
}
}
